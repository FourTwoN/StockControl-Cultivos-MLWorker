┌─────────────────────────────────────────────────────────────────────┐
  │                         IMAGEN ORIGINAL                             │
  └─────────────────────────────────────────────────────────────────────┘
                                │
                                ▼
  ┌─────────────────────────────────────────────────────────────────────┐
  │              SEGMENTACIÓN (YOLO v11)                                │
  │  → cajon[] + segmento[]                                             │
  │  → FILTER: mantiene solo el segmento MÁS GRANDE por área            │
  └─────────────────────────────────────────────────────────────────────┘
                                │
                ┌───────────────┴───────────────┐
                ▼                               ▼
  ┌──────────────────────────┐    ┌──────────────────────────┐
  │   cajon → YOLO Standard  │    │  segmento → SAHI Tiled   │
  │   (rápido, sin tiles)    │    │  (512x512, 25% overlap)  │
  └──────────────────────────┘    └──────────────────────────┘
                │                               │
                │     asyncio.gather()          │
                └───────────────┬───────────────┘
                                ▼
  ┌─────────────────────────────────────────────────────────────────────┐
  │                    CONVERGENCIA                                     │
  │  all_detections = cajon_detections + segmento_detections            │
  └─────────────────────────────────────────────────────────────────────┘
                                │
                                ▼
  ┌─────────────────────────────────────────────────────────────────────┐
  │           BAND ESTIMATION (áreas no detectadas)                     │
  │  → 4 bandas horizontales                                            │
  │  → Floor suppression (HSV + Otsu)                                   │
  │  → estimate_count = processed_area / avg_plant_area                 │
  └─────────────────────────────────────────────────────────────────────┘
                                │
                                ▼
  ┌─────────────────────────────────────────────────────────────────────┐
  │           SIZE CALCULATION (z-score con normalización por banda)    │
  │  → Normaliza heights por banda (corrige perspectiva)                │
  │  → z < -2.0: S | -1≤z≤1: Modal | z > 2.0: XL                       │
  └─────────────────────────────────────────────────────────────────────┘
                                │
                                ▼
  ┌─────────────────────────────────────────────────────────────────────┐
  │           SPECIES DISTRIBUTION (equitativo)                         │
  │  → Distribuye detections + estimations entre species configuradas   │
  └─────────────────────────────────────────────────────────────────────┘